{"version":3,"sources":["webpack:///./src/app/api-def.ts","webpack:///./src/app/students/students.module.ts","webpack:///./src/app/students/students.page.html","webpack:///./src/app/students/students.page.scss","webpack:///./src/app/students/students.page.ts"],"names":[],"mappings":"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","file":"students-students-module.js","sourcesContent":["export const API = {\r\n    putCourseTask: 'http://www.dungbeetles.xyz:8000/online-course-helper/putCourseTask',\r\n    getStudentStatus:'http://www.dungbeetles.xyz:8000/online-course-helper/getStudentStatus',\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\nimport { IonicModule } from '@ionic/angular';\nimport { StudentsPage } from './students.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: StudentsPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [StudentsPage]\n})\nexport class StudentsPageModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>\\n      学生控制\\n    </ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n        <ion-button slot=\\\"icon-only\\\" color=\\\"royal\\\" (click)=\\\"addClick()\\\">\\n          <ion-icon name=\\\"add\\\"></ion-icon>\\n        </ion-button>\\n      </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content padding>\\n  <div style=\\\"display: flex\\\">\\n        <h5>课程：{{course}}</h5>\\n  </div>\\n  <div style=\\\"display: flex;\\\">\\n    <h5>当前可听课学生：{{numberOfEnteredRobots}}</h5>\\n    <div style=\\\"flex: 1;\\\"></div>\\n    <div style=\\\"flex: 1;\\\"></div>\\n    <ion-button (click)=\\\"enterClick()\\\">进入教室</ion-button>\\n  </div>\\n\\n  <div style=\\\"display: flex;\\\">\\n    <ion-button (click)=\\\"interactionsClick()\\\">学生互动</ion-button>\\n    <ion-button (click)=\\\"questionsClick()\\\">学生提问</ion-button>\\n    <div style=\\\"flex: 1;\\\"></div>\\n    <ion-button color=\\\"danger\\\" (click)=\\\"leaveClick()\\\">学生离开</ion-button>\\n  </div>\\n  <ion-list>\\n      <ion-item-sliding *ngFor=\\\"let item of items\\\">\\n          <ion-item>\\n            <h5><ion-text color=\\\"primary\\\">{{ item.status }}:</ion-text>{{ item.text }}</h5>\\n          </ion-item>\\n          <ion-item-options side=\\\"end\\\">\\n            <ion-button (click)=\\\"removeClick(item.text)\\\" color=\\\"danger\\\">移除</ion-button>\\n          </ion-item-options>\\n        </ion-item-sliding>\\n  </ion-list>\\n</ion-content>\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3N0dWRlbnRzL3N0dWRlbnRzLnBhZ2Uuc2NzcyJ9 */\"","import { Component, OnInit } from '@angular/core'\nimport { ActivatedRoute, Router } from '@angular/router'\nimport { HttpClient, HttpHeaders } from \"@angular/common/http\"\nimport { ModalController } from '@ionic/angular';\nimport { Storage } from '@ionic/storage';\nimport { TitlePage } from '../title/title.page'\nimport { API } from '../api-def'\nimport { stringify } from 'querystring';\n\n@Component({\n  selector: 'app-students',\n  templateUrl: './students.page.html',\n  styleUrls: ['./students.page.scss'],\n})\nexport class StudentsPage implements OnInit {\n  students = []\n  items = []\n  course: string\n  buttonEnteredDisabled: boolean = false\n  buttonLeaveDisabled: boolean = true\n  numberOfEnteredRobots = 0\n\n  constructor(\n    public storage: Storage,\n    public router: Router,\n    public http: HttpClient,\n    public modalController: ModalController,\n    public activeRoute: ActivatedRoute) {\n    activeRoute.queryParams.subscribe(params => {\n      this.course = params.course\n    })\n  }\n\n  async ngOnInit() {\n    this.students = await this.storage.get('students')\n    for (let s of this.students) this.items.push({ status: '学生离线', text: s })\n    this.numberOfEnteredRobots = this.students.length\n  }\n\n  updateStatus = () => {\n    this.items.splice(this.students.length - 1, this.items.length - this.students.length)\n\n    for (let i = 0; i < this.students.length; i++) {\n      this.http.get(API.getStudentStatus, { params: { account: this.students[i].split(':')[0] } }).subscribe(res => {\n        let item = { status: res['err'] ? '接口错误' : res['ret'] ? res['ret'] : '学生离线' , text: this.students[i] }\n        if (i < this.items.length) this.items[i] = item\n        else this.items.push(item)\n      }, err => {\n        let item = { status: '网络错误', text: this.students[i] }\n        if (i < this.items.length) this.items[i] = item\n        else this.items.push(item)\n      })\n    }\n\n    if (this.timer) setTimeout(this.updateStatus, 10000)\n  }\n\n  timer = null\n  async enterClick() {\n    clearTimeout(this.timer)\n    let accounts = []\n    for (let s of this.students) accounts.push(s.split(':'))\n    this.http.post(API.putCourseTask, {\n      course: this.course,\n      accounts: accounts,\n      interactions: await this.storage.get('interactions'),\n      questions: await this.storage.get('questions')\n    }, { headers: { 'Content-Type': 'application/x-www-form-urlencoded' } }).subscribe(res => {\n      if(!res['ret']) return;\n      alert('命令已发送！')\n      this.timer = setTimeout(this.updateStatus)\n    }, err => {\n      console.error(err)\n    })\n  }\n\n  leaveClick() {\n    clearTimeout(this.timer)\n    this.timer = null\n  }\n\n  async addClick() {\n    let m = await this.modalController.create({ component: TitlePage })\n    await m.present()\n    let ret = await m.onDidDismiss()\n    let value = ret.data\n    if (value != null) {\n      this.items.push({ status: '学生离线', text: value })\n      this.students.push(value)\n      await this.storage.set('students', this.students)\n      this.numberOfEnteredRobots = this.students.length\n    }\n  }\n\n  async removeClick(item) {\n    let i = this.students.indexOf(item)\n    this.students.splice(i, 1)\n    await this.storage.set('students', this.students)\n    this.items.splice(i, 1)\n    this.numberOfEnteredRobots = this.students.length\n  }\n\n  interactionsClick() {\n    this.router.navigate(['/interactions'])\n  }\n\n  questionsClick() {\n    this.router.navigate(['/questions'])\n  }\n}\n"],"sourceRoot":""}